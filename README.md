# ğŸ“¡ğŸ”— iot-trace-chain

Hybrid architecture combining IoT, blockchain, and big data for secure traceability of waste data.

---

## ğŸ§  Overview

This project is part of a Master's Thesis and proposes a scalable architecture to ensure the traceability, integrity, and availability of data generated by IoT devices in waste management scenarios.

The solution combines:

- ğŸ”§ IoT devices connected via MQTT
- ğŸ“¦ Massive storage in Parquet format on a Data Lake (MinIO + Delta Lake)
- ğŸ” Integrity verification using Merkle trees and blockchain (Ethereum/Hardhat)
- ğŸ“Š Optional visualization and analysis with DuckDB, Dremio, or other tools

---

## ğŸ§± Architecture

```plaintext
[IoT Device] --> MQTT --> Persistence Worker --> 
    [Delta Lake (MinIO)] + [Blockchain (Merkle Root)]
```

---

## ğŸš€ Main Services (Docker Compose)

| Service              | Description                                        |
|----------------------|----------------------------------------------------|
| `persistence-worker` | Processes, validates, and stores IoT data          |
| `minio`              | S3-compatible storage backend for the Data Lake    |
| `hardhat-node`       | Local blockchain node (Ethereum)                   |
| `mosquitto`          | MQTT broker receiving sensor messages              |
| `duckdb`             | Optional tools for data exploration and querying   |

---

## ğŸ“¦ Project Structure

```
.
â”œâ”€â”€ persistence-worker/       # Main worker code (Python, Spark)
â”œâ”€â”€ blockchain/               # Smart contracts and Hardhat scripts
â”œâ”€â”€ mosquitto/                # MQTT broker configuration
â”œâ”€â”€ minio-mirror/             # Local copy for DuckDB querying
â”œâ”€â”€ docker-compose.yaml       # Service orchestration
â””â”€â”€ README.md                 # This file -> Project documentation
```

---

## ğŸ›  Technologies

- Python 3.12
- Apache Spark + PySpark
- Delta Lake
- MQTT (Eclipse Mosquitto)
- Ethereum + Hardhat
- MinIO (S3-compatible)
- DuckDB / Dremio (optional)
- Docker Compose

---

## âš™ï¸ Quick Start

### ğŸ”§ Start environment:

```bash
docker compose up --build
```

### ğŸ“¦ Run a manual service (e.g., MQTT Explorer):

```bash
docker compose --profile manual up mqtt-explorer
```

### ğŸ Run the worker manually:

```bash
cd persistence-worker
poetry install
poetry run poe start-local
```

If you want to run the worker with time of function execution, you can use the following command:

```bash
poetry run poe start-local-profiling
```

Additionally, if you want to send a test MQTT message, you can do so with the following command:

```bash
poetry run poe publish-message
```

---

## ğŸ“š Documentation

TODO

## ğŸ“„ License

This project is licensed under the MIT License and developed as part of the [Master's in Business Intelligence and Big Data in Secure Environments (UBu, ULe, UVa)](https://www.inf.uva.es/master-online/) in Spain. 

---

## ğŸ‘¨â€ğŸ“ Author

Javier Alonso-NÃºÃ±ez  
[LinkedIn](https://www.linkedin.com/in/javier0alonso/) â€¢ [GitHub](https://github.com/javalon) â€¢ [ORCID](https://orcid.org/0009-0004-3085-5007)

